<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        table {
            width: 800px;
            border-collapse: collapse;
        }

        button {
            background-color: greenyellow;
            padding: 10px 20px;
            margin: 0px 5px;
            border-radius: 10px;
            border: none;
            transition: all 0.2s ease-out;
        }

        button:hover {
            background-color: #45a049;
            /* đổi màu khi hover */
            transform: translateY(-2px);
            /* hơi nhấc lên */
        }

        button:active {
            transform: translateY(2px);
            /* nhấn xuống */
            box-shadow: 0 1px #2e7d32;
            /* bóng đổ ngắn lại */
        }

        tbody tr:nth-child(even) {
            background-color: hsl(0, 3%, 95%);
        }

        td,
        th {
            padding: 10px 0px 10px 10px;
            text-align: left;
            border: none;
        }
    </style>
</head>

<body>
    <h2>
        Add new Product
    </h2>
    <div class="add-product">
        <input type="text" name="product-name" id="product-name" placeholder="New Product" required>
        <input type="button" value="Add" id="add-product">
    </div>
    <h2>
        Display All Products
    </h2>
    <table id="tb-products">
        <thead>
            <tr>
                <th>Numbers</th>
                <th>ID</th>
                <th>Product Name</th>
                <th colspan="2">
                </th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
    <script>
        const hotPhones2025 = [
            {
                id: 1,
                name: "iPhone 17 Pro Max",
                price: '$16'
            },
            {
                id: 2,
                name: "Samsung Galaxy S25 Ultra",
                price: '$16'
            },
            {
                id: 3,
                name: "Google Pixel 10 Pro XL",
                price: '$16'
            },
            {
                id: 4,
                name: "Oppo Find X9 Pro",
                price: '$16'
            },
            {
                id: 5,
                name: "Apple iPhone 17",
                price: '$16'
            },
        ];
        class Product {
            id
            name
            price
            constructor(id, name, price) {
                this.id = id;
                this.name = name;
                this.price = price;
            }
        }
        class ManagerProduct {
            products
            constructor(products) {
                this.products = products;
            }
            deleteProduct(id) {
                const index = this.products.findIndex(function (product, index, array) {
                    return product.id === id;
                });
                if (index > -1) {
                    return this.products.splice(index, 1)[0];
                }
                return undefined;
            }
            editProduct(id, name) {
                const index = this.products.findIndex(function (product, index, array) {
                    return product.id === id;
                });
                if (index > -1) {
                    this.products[index].name = name;
                }
            }
            addProduct(product) {
                this.products.push(product);
            }
            getTotalProduct() {
                return this.products.length;
            }
        }

        const tbody = document.querySelector('#tb-products tbody');
        const txtProductName = document.getElementById('product-name');
        const btnAdd = document.getElementById('add-product');

        const managerProduct = new ManagerProduct(hotPhones2025);


        function loadTotalProducts() {
            document.querySelector("#tb-products thead tr th:nth-child(4)").innerText = managerProduct.getTotalProduct() + " products";
        }
        //createElement.
        function createRow(index, id, productName) {
            const tr = document.createElement("tr");

            const tdIndex = document.createElement("td");
            tdIndex.textContent = index;

            const tdID = document.createElement("td");
            tdID.textContent = id;

            const tdName = document.createElement("td");
            tdName.textContent = productName;

            tdName.addEventListener('click', function (event) {
                txtProductName.value = tdName.innerText;
            });

            const tdAction = document.createElement("td");
            const btnDel = document.createElement("button");
            btnDel.textContent = "Delete";
            tdAction.appendChild(btnDel);

            btnDel.addEventListener('click', function (event) {
                const isConfirm = confirm("Do you want to delete this product?");
                if (isConfirm === false) {
                    return;
                }
                const product = managerProduct.deleteProduct(id);
                alert(`Deleted product : ${product.name}`);
                loadTable();
            });

            const btnEdit = document.createElement("button");
            btnEdit.textContent = "Edit";
            tdAction.appendChild(btnEdit);

            btnEdit.addEventListener('click', function () {
                if (txtProductName.value.trim() === "") {
                    return;
                }
                const isConfirm = confirm("Do you want to edit this product?");
                if (isConfirm === false) {
                    return;
                }
                const productName = txtProductName.value;
                managerProduct.editProduct(id, productName);
                txtProductName.value = "";
                loadTable();
            });

            tr.append(tdIndex, tdID, tdName, tdAction);
            return tr;
        }
        function loadTable() {
            tbody.innerHTML = "";
            managerProduct.products.forEach(function (product, index, array) {
                tbody.append(createRow(index, product.id, product.name));
            });
            loadTotalProducts();
        }
        btnAdd.addEventListener('click', function (event) {
            const productName = document.getElementById('product-name').value;
            const newProduct = new Product(managerProduct.getTotalProduct() + 1, productName, "$20");
            managerProduct.addProduct(newProduct);
            loadTotalProducts();
            loadTable();
        });

        loadTable();
    </script>
</body>

</html>